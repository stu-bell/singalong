{
    "image": "mcr.microsoft.com/devcontainers/typescript-node",
    "features": {
        "ghcr.io/duduribeiro/devcontainer-features/neovim:1": {}
    },
    "containerEnv": {
        // update config home for neovim. Alternatively, symlink: "postCreateCommand": "ln -sf /config/nvim ~/.config/nvim",
        "XDG_CONFIG_HOME": "/config"
    },
    "mounts": [
        // mount host nvim config to container
        // Note: nvim may hang for a few minutes when initially loading plugins. Use `nvim --noplugin` or disable unneeded plugins
        // LINUX HOST: replace source with your host nvim config location
        // "source=${localEnv:HOME}/.config/nvim/,target=/config/nvim,type=bind",
        // WINDOWS HOST: replace source with your host nvim config location
        "source=${localEnv:LOCALAPPDATA}/nvim/,target=/config/nvim,type=bind",

        // keep node_modules in the container, not the host
        "source=node_modules,target=${containerWorkspaceFolder}/node_modules,type=volume"
    ],
    // since we're mounting the node_modules as a volume, change ownership from root to user
    "postCreateCommand": "sudo chown -R $(id -u):$(id -g) node_modules && npm install",

    // port forwarding for vite dev server
    "forwardPorts": [5173],
    "portsAttributes": {
        "5173": {
            "label": "Vite Dev Server"
        }
    },
    // open in the /workspace directory
    "workspaceFolder": "/workspace"
}
